---
fontsize: 11pt
documentclass: article
bibliography: Endnote_lib.bib
csl: reference-style.csl
output:
  rmarkdown::pdf_document:
    fig_caption: yes
    keep_tex: yes
    includes:
      in_header: [preamble-latex.tex, preamble-latex3.tex]
---
## Supporting Information
All data and code is stored in an online repository (\url{www.github.com/paleo13/genetic.surrogates}) to replicate analyses in this study. See the \textit{README} file for instructions.


```{r, include=FALSE}
# set wd
setwd('..')

# load .rda file
session::restore.session('results/results.rda')

# set options
options(error=NULL)

# download basemap
data(countriesHigh)
countries.FPLY <- countriesHigh[
	countriesHigh$ADMIN %in% c(
		'Italy', 'Switzerland', 'France', 'Austria',
		'Germany', 'Slovenia', 'Croatia', 'Hungary',
		'Monaco', 'Germany', 'Slovakia', 'Czech Republic'
	)
,] %>% spFortify
grid.FPLY <- spFortify(grid.PLY)
```

```{r, echo=FALSE, fig.width=9.5, fig.height=10, out.width='7.5in', out.height='8.5in', fig.cap='Species distributions. Squares represent planning units. For a given species, planning units that were found to be inhabited are denoted with bright blue.'}
## plot map of species distributions
# fortify data
spp.grid.FPLY <- ldply(unique(spp.samples.DF$species), function(x) {
		z <- grid.FPLY[,c('long', 'lat', 'group', x),drop=FALSE]
		names(z)[4] <- 'presence'
		z$species <- gsub('\\_', ' ', x)
		return(z)
	}
)
# plot species data
ggplot() +
	geom_polygon(data=countries.FPLY, aes(x=long, y=lat, group=group),
		fill='grey85', color='grey70') +
	geom_polygon(data=spp.grid.FPLY, aes(x=long, y=lat, 
		group=group, fill=presence), alpha=0.8, color='grey10') +
	theme_classic() +
	guides(fill=guide_legend(title='Presence')) +
	theme(axis.ticks=element_blank(), axis.text=element_blank(),
		axis.line=element_blank(), 
		strip.background = element_rect(fill='grey20'),
		strip.text = element_text(color='white', face='italic'),
		axis.title=element_blank()
	) +
	coord_cartesian(
		xlim=buffered.range(grid.FPLY$long, 0),
		ylim=buffered.range(grid.FPLY$lat, 0)
	) +
	facet_wrap(~ species, ncol=4)
```

```{r, echo=FALSE, fig.width=4, fig.height=3.5, fig.cap="Species richness. Squares denote planning units. Planning units with a brighter color are inhabited by more species."}
# calculate species richness
grid.PLY$Species_richness <- grid.PLY@data %>%
	select(5:(4+n_distinct(spp.samples.DF$species))) %>% as.matrix() %>% rowSums()

# plot species richness
ggplot() +
	geom_polygon(data=countries.FPLY, aes(x=long, y=lat, group=group),
		fill='grey85', color='grey70') +
	geom_polygon(data=spFortify(grid.PLY), aes(x=long, y=lat, 
		group=group, fill=Species_richness), color='grey10') +
	scale_fill_gradientn(name='Count (#)',
		colors=brewer.pal(9,'PuBu'),
		guide=guide_colorbar(ticks=element_line(color='black'), border=element_line(color='black'))
	) +
	theme_classic() +
	theme(axis.ticks=element_blank(), axis.text=element_blank(),
		axis.line=element_blank(), axis.title=element_blank(),
		panel.border=element_rect(color='black', fill=NA, size=1)
	) +
	coord_cartesian(
		xlim=buffered.range(grid.FPLY$long, 0),
		ylim=buffered.range(grid.FPLY$lat, 0)
	) + 
	ggtitle('Species Richness')
```

```{r, echo=FALSE, fig.width=4, fig.height=3.5, fig.cap="Opportunity cost. Squares denote planning units. The color of each planning unit represents its opportunity cost (computed as total population density)"}
# plot opportunity costs
ggplot() +
	geom_polygon(data=countries.FPLY, aes(x=long, y=lat, group=group),
		fill='grey85', color='grey70') +
	geom_polygon(data=spFortify(grid.PLY), aes(x=long, y=lat, 
		group=group, fill=pop.density), color='grey10') +
	scale_fill_gradientn(name='Cost',
		colors=brewer.pal(9, 'PuBu'),
		guide=guide_colorbar(ticks=element_line(color='black'), border=element_line(color='black'))
	) +
	theme_classic() +
	theme(axis.ticks=element_blank(), axis.text=element_blank(),
		axis.line=element_blank(), axis.title=element_blank(),
		panel.border=element_rect(color='black', fill=NA, size=1)
	) +
	coord_cartesian(
		xlim=buffered.range(grid.FPLY$long, 0),
		ylim=buffered.range(grid.FPLY$lat, 0)
	) +
	ggtitle('Opportunity cost')
```


```{r, fig.width=8, fig.height=3.5, fig.cap='Climatic variation. Each panel depicts variation based on a different principle component (PC). Squares represent planning units. The color of each planning unit denotes the average PC value of pixels inside it. Planning units with more similar colors have more similar climate regimes.', echo=FALSE}
do.call(
	grid.arrange,
		append(
		llply(grep('^env\\_.*$', names(grid.DF), value=TRUE), function(x) {
			grid.FPLY$plot_title <- paste0('PC ', substr(x, nchar(x), nchar(x)))
			ggplot() +
				geom_polygon(data=countries.FPLY, aes(x=long, y=lat, group=group),
					fill='grey85', color='grey70') +
				geom_polygon(data=grid.FPLY, aes_string(x='long', y='lat', 
					group='group', fill=x), color='grey10') +
				theme_classic() +
				theme(axis.ticks=element_blank(), axis.text=element_blank(),
					plot.margin=unit(c(0,0,0,0),'cm'), axis.line=element_blank(), 
					axis.title=element_blank(), 
					panel.border=element_rect(color='black', fill=NA, size=1),
					strip.background = element_rect(fill='grey20'),
					strip.text = element_text(color='white')
				) +
				coord_cartesian(
					xlim=buffered.range(grid.FPLY$long, 0),
					ylim=buffered.range(grid.FPLY$lat, 0)
				) +
				scale_fill_gradientn(name='',
					colors=brewer.pal(9, 'RdYlBu'),
					guide=guide_colorbar(ticks=element_line(color='black'), border=element_line(color='black'))
				) +
				facet_wrap(~ plot_title)
		}),
		list(ncol=2)
	)
)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=9.5, fig.height=10, fig.cap='Relative support ($BIC$) for the number of populations in each species. Each panel denotes a different species. Asterisks indicate the number of populations with the most support (see text for methodological details).'}
# format data
bic.buff <- laply(spp.Adegenet.LST, `[[`, 'Kstat') %>%
	c() %>% range() %>% diff %>% `*`(0.05)
bic.DF <- ldply(
	seq_along(unique(spp.samples.DF$species)),
	.fun=function(i) {
		data.frame(
			k=as.numeric(gsub('K=', '', names(spp.Adegenet.LST[[i]]$Kstat), fixed=TRUE)),
			stat=unname(spp.Adegenet.LST[[i]]$Kstat),
			best_k=as.numeric(gsub('K=', '', names(spp.Adegenet.LST[[i]]$stat), fixed=TRUE)),
			best_stat=unname(spp.Adegenet.LST[[i]]$stat) + bic.buff,
			asterisk_col=c('black',rep('transparent', length(spp.Adegenet.LST[[i]]$Kstat)-1)),
			Species=gsub('_', ' ', unique(spp.samples.DF$species)[i], fixed=TRUE)
		)
	}
)
# make plot
suppressWarnings({
	ggplot(data=bic.DF) +
		geom_point(aes(y=stat, x=k)) +
		geom_point(aes(y=best_stat, x=best_k), size=4, shape=8) +
		geom_line(aes(y=stat, x=k)) +
		theme_classic() +
		theme(
			strip.background = element_rect(fill='grey20'),
			strip.text = element_text(color='white', face='italic', size=20)
		) +
		xlab('Number of populations') +
		ylab('BIC') +
		facet_wrap(~ Species, ncol=4)
})
```

```{r, echo=FALSE, fig.width=15, fig.height=14, fig.cap='Distribution of populations. Each panel depicts a different species. Squares denote planning units. Points denote the location of sampled individuals, and their colors denote the distribution of populations. Note that points have been slightly jittered so that individuals in close proximity are visible.'}
# prepare data
pop.DF <- llply(
	seq_along(unique(spp.samples.DF$species)),
	function(i) {
		curr.pts <- filter(
			spp.sample.PTS@data,
			species==unique(spp.samples.DF$species)[i]
		) %>% mutate(
			species=gsub('_', ' ', unique(spp.samples.DF$species)[i], fixed=TRUE),
			population=spp.Adegenet.LST[[i]]$grp
		)
	}
) %>% do.call(what=rbind)
# make plot
ggplot() +
	geom_polygon(data=countries.FPLY, aes(x=long, y=lat, group=group),
		fill='grey85', color='grey75') +
	geom_polygon(data=grid.FPLY, aes_string(x='long', y='lat', 
		group='group'), fill='transparent', color='grey10') +
	geom_point(data=pop.DF, aes_string(x='sample.longitude', y='sample.latitude', 
		color='population'), alpha=0.8, size=3, position='jitter') +
	guides(fill=guide_legend(title=''), color=guide_legend(title='')) +
	theme_classic() +
	theme(axis.ticks=element_blank(), axis.text=element_blank(),
		plot.margin=unit(c(0,0,0,0),'cm'), axis.line=element_blank(), 
		axis.title=element_blank(), 
		strip.background = element_rect(fill='grey20'),
		strip.text = element_text(color='white', face='italic', size=20),
		legend.text= element_text(size=20)
	) +
	coord_cartesian(
		xlim=buffered.range(grid.FPLY$long, 0),
		ylim=buffered.range(grid.FPLY$lat, 0)
	) +
	facet_wrap(~ species, ncol=4)
```

```{r, echo=FALSE}
plot.spp.nmds <- function(i) {
	## prepare data
	# get vector of adaptive and neutral column names
	adapt.col <- grep(
		paste0(unique(spp.samples.DF$species)[i], '_adaptive_d'),
		names(grid.FPLY), value=TRUE, fixed=TRUE
	)
	neutral.col <- grep(
		paste0(unique(spp.samples.DF$species)[i], '_neutral_d'),
		names(grid.FPLY), value=TRUE, fixed=TRUE
	)
	curr.FPLY <- grid.FPLY[,
		c(adapt.col, neutral.col,
		'long','lat','group'),drop=FALSE]
	curr.FPLY <- curr.FPLY %>% gather(d, value, contains('adaptive'), contains('neutral')) %>% mutate(
		d=gsub(paste0(unique(spp.samples.DF$species)[i], '_'), '', d, fixed=TRUE),
		d=gsub('_', ' ', d, fixed=TRUE)
	)
	for (j in seq_len(length(adapt.col)+length(neutral.col)))
		curr.FPLY[['d']] <- gsub(as.character(j), paste0('(', j, ')'), curr.FPLY[['d']], fixed=TRUE)
	curr.FPLY <- curr.FPLY %>% mutate(d=factor(gsub(' d(', ' (', d, fixed=TRUE)))
	# make plot
	ggplot() +
		geom_polygon(data=countries.FPLY, aes(x=long, y=lat, group=group),
			fill='grey85', color='grey70') +
		geom_polygon(data=curr.FPLY, aes_string(x='long', y='lat', 
			group='group', fill='value'), color='grey10') +
		theme_classic() +
		theme(axis.ticks=element_blank(), axis.text=element_blank(),
			plot.margin=unit(c(0,0,0,0),'cm'), axis.line=element_blank(),
			axis.title=element_blank(), strip.background = element_rect(fill='grey20'),
			strip.text = element_text(color='white', size=20),
			legend.text = element_text(size=20)
		) +
		coord_cartesian(
			xlim=buffered.range(grid.FPLY$long, 0),
			ylim=buffered.range(grid.FPLY$lat, 0)
		) +
		scale_fill_gradientn(name='',
			colors=brewer.pal(9, 'RdYlBu'),
			guide=guide_colorbar(ticks=element_line(color='black'),
				border=element_line(color='black'), barheight=unit(7, 'cm'))
		) +
		facet_wrap(~ d, ncol=4)
}

calc.fig.height <- function(i) {
	# init
	adapt.col <- paste0(unique(spp.samples.DF$species)[i], '_adaptive_d1')
	neutral.col <- paste0(unique(spp.samples.DF$species)[i], '_neutral_d1')
	n.plots <- 0 
	# count adaptive plot
	if (adapt.col %in% names(grid.FPLY))
		n.plots <- n.plots + spp.nmds.LST[[i]][['adaptive']]$ndim
	# count neutral plot
	if (neutral.col %in% names(grid.FPLY))
		n.plots <- n.plots + spp.nmds.LST[[i]][['neutral']]$ndim
	# exports
	return(ceiling(n.plots/4) * 3.5)
}
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(1), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[1]),'}. Each panel shows a different dimension of the variation as indicated by its title. Squares represent planning units. The color of each planning unit panel corresponds to the average ordinated values associated with individuals sampled inside it. No indiviudals of this species were found inside the gray planning units.')}
if (1 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(1)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(2), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[2]),'}. See Figure S6 caption for conventions.')}
if (2 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(2)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(3), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[3]),'}. See Figure S6 caption for conventions.')}
if (3 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(3)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(4), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[4]),'}. See Figure S6 caption for conventions.')}
if (4 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(4)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(5), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[5]),'}. See Figure S6 caption for conventions.')}
if (5 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(5)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(6), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[6]),'}. See Figure S6 caption for conventions.')}
if (6 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(6)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(7), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[7]),'}. See Figure S6 caption for conventions.')}
if (7 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(7)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(8), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[8]),'}. See Figure S6 caption for conventions.')}
if (8 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(8)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(9), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[9]),'}. See Figure S6 caption for conventions.')}
if (9 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(9)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(10), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[10]),'}. See Figure S6 caption for conventions.')}
if (10 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(10)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(11), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[11]),'}. See Figure S6 caption for conventions.')}
if (11 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(11)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(12), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[12]),'}. See Figure S6 caption for conventions.')}
if (12 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(12)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(13), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[13]),'}. See Figure S6 caption for conventions.')}
if (13 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(13)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(14), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[14]),'}. See Figure S6 caption for conventions.')}
if (14 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(14)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(15), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[15]),'}. See Figure S6 caption for conventions.')}
if (15 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(15)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(16), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[16]),'}. See Figure S6 caption for conventions.')}
if (16 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(16)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(17), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[17]),'}. See Figure S6 caption for conventions.')}
if (17 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(17)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(18), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[18]),'}. See Figure S6 caption for conventions.')}
if (18 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(18)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(19), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[19]),'}. See Figure S6 caption for conventions.')}
if (19 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(19)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(20), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[20]),'}. See Figure S6 caption for conventions.')}
if (20 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(20)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(21), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[21]),'}. See Figure S6 caption for conventions.')}
if (21 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(21)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(22), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[22]),'}. See Figure S6 caption for conventions.')}
if (22 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(22)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(23), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[23]),'}. See Figure S6 caption for conventions.')}
if (23 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(23)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(24), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[24]),'}. See Figure S6 caption for conventions.')}
if (24 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(24)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(25), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[25]),'}. See Figure S6 caption for conventions.')}
if (25 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(25)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(26), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[26]),'}. See Figure S6 caption for conventions.')}
if (26 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(26)
```

```{r, echo=FALSE, fig.width=15, fig.height=calc.fig.height(27), fig.cap=paste0('Distribution of adaptive and neutral genetic variation in \\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[27]),'}. See Figure S6 caption for conventions.')}
if (27 <= general.params.LST[[MODE]]$n.spp) plot.spp.nmds(27)
```

```{r, echo=FALSE}
## make results table showing Eigen values
knitr::kable(
	pca.DF,
	digits=2,
	caption='Summary of principle components analysis (PCA) on bioclimatic variation across the study area. The first two principle components (PCs) were used for subsequent analysis.',
	align=c('l', 'c', 'c', 'c')
)
```

```{r, echo=FALSE}
knitr::kable(
	format.table(
		ldply(
			seq_along(unique(spp.samples.DF$species)), 
			function(i) {
				data.frame(
					Species=paste0('\\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[i]),'}'),
					Primer=spp.BayeScan.sample.loci.subset.LST[[i]]@data@primers,
					Probability=spp.BayeScan.sample.loci.subset.LST[[i]]@results@summary[[2]],
					qval=spp.BayeScan.sample.loci.subset.LST[[i]]@results@summary[[4]],
					alpha=spp.BayeScan.sample.loci.subset.LST[[i]]@results@summary[[5]],
					fst=spp.BayeScan.sample.loci.subset.LST[[i]]@results@summary[[6]],
					Type=spp.BayeScan.sample.loci.subset.LST[[i]]@results@summary[[7]]
				)
			}
		),
		omit='Type'
	),
	digits=2,
	col.names=c('Species', 'Primer', 'Probability', 'q-value', '$\\alpha$', '$F_{ST}$', 'Type'),
	align=c('l', 'c', 'c', 'c', 'c', 'c', 'c'),
	caption='Loci classifications for each species. Each row denotes a sampled loci for a given species, and the evidence for it being under selection based on outputs from the program \\texttt{Bayescan}.'
)
```

```{r, echo=FALSE}
knitr::kable(
	format.table(
		filter(
			ldply(
				seq_along(unique(spp.samples.DF$species)), 
				function(i) {
					ldply(
						seq_along(spp.nmds.LST[[i]]),
						function(j) {
						data.frame(
							Species=paste0('\\textit{',gsub('\\_', ' ', unique(spp.samples.DF$species)[i]),'}'),
							Loci=names(spp.nmds.LST[[i]])[j],
							k=ifelse(is.null(spp.nmds.LST[[i]][[j]]), NA_integer_, spp.nmds.LST[[i]][[j]]$ndim),
							Stress=ifelse(is.null(spp.nmds.LST[[i]][[j]]), NA_real_, spp.nmds.LST[[i]][[j]]$stress),
							Converged=ifelse(is.null(spp.nmds.LST[[i]][[j]]), NA, spp.nmds.LST[[i]][[j]]$converged)
						)
					})
				}
			),
			!is.na(Stress)
		),
		omit=c('Loci','Converged')
	),
	digits=2,
	caption='Summary of non-metric multi-dimensional scaling (MDS) analyses on genetic variation for each species.',
	col.names=c('Species', 'Loci Type', 'k', 'NMDS Stress', 'Converged'),
	align=c('l', 'c', 'c', 'c', 'c')
)
```

