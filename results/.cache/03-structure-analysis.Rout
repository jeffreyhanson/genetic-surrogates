
R version 3.2.2 (2015-08-14) -- "Fire Safety"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Revolution R Open 3.2.2
The enhanced R distribution from Revolution Analytics
[Previously saved workspace restored]

> ## load .rda
> session::restore.session('results/.cache/02-surrogate-data.rda')
Loading all data...
Loading packages...

Attaching package: ‘dplyr’

The following objects are masked from ‘package:plyr’:

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize

The following objects are masked from ‘package:data.table’:

    between, last

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

This is vegan 2.3-2
rgeos version: 0.3-15, (SVN revision 515)
 GEOS runtime version: 3.4.2-CAPI-1.8.2 r3921 
 Linking to sp version: 1.2-1 
 Polygon checking: TRUE 


Attaching package: ‘snow’

The following objects are masked from ‘package:parallel’:

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, clusterSplit, makeCluster, parApply,
    parCapply, parLapply, parRapply, parSapply, splitIndices,
    stopCluster

rgdal: version: 1.1-1, (SVN revision 572)
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 1.10.1, released 2013/08/26
 Path to GDAL shared files: /usr/share/gdal/1.10
 Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
 Path to PROJ.4 shared files: (autodetected)
 Linking to sp version: 1.2-1 

Attaching package: ‘raster’

The following object is masked _by_ ‘.GlobalEnv’:

    select

The following object is masked from ‘package:tidyr’:

    extract

The following object is masked from ‘package:dplyr’:

    select

The following object is masked from ‘package:data.table’:

    shift


Attaching package: ‘structurer’

The following objects are masked from ‘package:bayescanr’:

    loci.subset, n.loci, n.pop, n.samples, sample.subset

Restoring search path...
Done.
> 
> 
> ### Structure analyses
> ## run analyses
> clust <- makeCluster(st.threads, type='SOCK')
> clusterEvalQ(clust, {library(structurer)})
[[1]]
[1] "structurer" "snow"       "methods"    "stats"      "graphics"  
[6] "grDevices"  "utils"      "datasets"   "base"      

> registerDoParallel(clust)
> spp.StructureCollection.LST <- llply(
+ 	spp.StructureData.LST,
+ 	run.Structure,
+ 	NUMRUNS=st.numruns,
+ 	MAXPOPS=st.k,
+ 	BURNIN=st.burnin,
+ 	NUMREPS=st.numreps,
+ 	NOADMIX=st.noadmix,
+ 	ADMBURNIN=st.admburnin,
+ 	REPEATS=cl.repeats,
+ 	M=cl.m,
+ 	S=cl.s,
+ 	.parallel=TRUE
+ )
Warning messages:
1: In setup_parallel() : No parallel backend registered
2: <anonymous>: ... may be used in an incorrect context: ‘.fun(piece, ...)’
 
3: <anonymous>: ... may be used in an incorrect context: ‘.fun(piece, ...)’
 
> clust <- stopCluster(clust)
> 
> ## assign populations
> spp.BayeScanData.sample.subset.LST <- llply(
+ 	seq_along(spp.BayeScanData.LST),
+ 	.fun=function(i) {
+ 		print(i)
+ 		# get population identities
+ 		ids <- sample.membership(spp.StructureCollection.LST[[i]], threshold=st.probthresh)
+ 		validPos <- which(!is.na(ids))
+ 		# remove individuals below threshold
+ 		curr.spp <- spp.BayeScanData.LST[[i]]
+ 		curr.spp <- bayescanr:::sample.subset.BayeScanData(curr.spp, validPos)
+ 		curr.spp@labels <- filter(spp.samples.DF, species==unique(spp.samples.DF$species)[i])$cell[validPos]
+ 		curr.spp@populations <- as.character(ids[validPos])
+ 		return(curr.spp)
+ 	}
+ )
[1] 1
[1] 2
[1] 3
> 
> ## load .rda
> save.session('results/.cache/03-stucture-analysis.rda')
Saving search path..
Saving list of loaded packages..
Saving all data...
Done.
> 
> proc.time()
   user  system elapsed 
 12.808   0.432  31.649 
